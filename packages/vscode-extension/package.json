{
  "name": "teamsfx-extension",
  "displayName": "Teams Toolkit V2",
  "description": "Create, debug, and deploy Teams apps directly from Teams Toolkit v2",
  "version": "1.0.4",
  "publisher": "Microsoft",
  "author": "Microsoft Corporation",
  "icon": "media/teams.png",
  "main": "./out/src/extension.js",
  "repository": {
    "type": "git",
    "url": "https://github.com/OfficeDev/TeamsFx"
  },
  "views": {
    "teamsfx-toolkit": [
      {
        "id": "teamsfx-toolkit",
        "name": "Commands"
      }
    ]
  },
  "engines": {
    "vscode": "^1.51.0"
  },
  "license": "MIT",
  "keywords": [
    "Microsoft Teams",
    "Azure",
    "M365"
  ],
  "categories": [
    "Azure",
    "Extension Packs",
    "Snippets"
  ],
  "aiKey": "AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217",
  "featureFlag": "true",
  "activationEvents": [
    "*",
    "onCommand:fx-extension.create",
    "onCommand:fx-extension.update",
    "onCommand:fx-extension.addCapability",
    "onCommand:fx-extension.provision",
    "onCommand:fx-extension.deploy",
    "onCommand:fx-extension.updateAad",
    "onCommand:fx-extension.validate-dependencies",
    "onCommand:fx-extension.pre-debug-check",
    "workspaceContains:**/.teamsfx/*",
    "onView:teamsfx"
  ],
  "contributes": {
    "viewsContainers": {
      "activitybar": [
        {
          "id": "teamsfx",
          "title": "Teams Toolkit v2",
          "icon": "media/teams.svg"
        }
      ]
    },
    "views": {
      "teamsfx": [
        {
          "id": "teamsfx",
          "name": "Commands"
        }
      ]
    },
    "menus": {
      "view/item/context": [
        {
          "command": "fx-extension.signOut",
          "when": "view == teamsfx && viewItem == signedinM365",
          "group": "inline"
        },
        {
          "command": "fx-extension.signOut",
          "when": "view == teamsfx && viewItem == signedinAzure",
          "group": "inline"
        }
      ],
      "commandPalette": [
        {
          "command": "fx-extension.signOut",
          "when": "false"
        }
      ]
    },
    "commands": [
      {
        "command": "fx-extension.signOut",
        "title": "Sign Out",
        "icon": "$(sign-out)"
      },
      {
        "command": "fx-extension.create",
        "title": "TeamsFx - Start A New Project"
      },
      {
        "command": "fx-extension.update",
        "title": "TeamsFx - Add Resource"
      },
      {
        "command": "fx-extension.addCapability",
        "title": "TeamsFx - Add Capability"
      },
      {
        "command": "fx-extension.provision",
        "title": "TeamsFx - Provision Resource"
      },
      {
        "command": "fx-extension.deploy",
        "title": "TeamsFx - Deploy Package"
      },
      {
        "command": "fx-extension.publish",
        "title": "TeamsFx - Publish Teams App"
      },
      {
        "command": "fx-extension.updateAad",
        "title": "TeamsFx - Update AAD Permission"
      },
      {
        "command": "fx-extension.validate-dependencies",
        "title": "TeamsFx - Validate Dependencies",
        "enablement": "never"
      },
      {
        "command": "fx-extension.pre-debug-check",
        "title": "TeamsFx - Pre Debug Check",
        "enablement": "never"
      },
      {
        "command": "fx-extension.backend-extensions-install",
        "title": "TeamsFx - Backend Extensions Install",
        "enablement": "never"
      }
    ],
    "taskDefinitions": [
      {
        "type": "teamsfx",
        "required": [
          "command"
        ],
        "properties": {
          "command": {
            "type": "string"
          }
        }
      }
    ],
    "problemMatchers": [
      {
        "name": "teamsfx-frontend-watch",
        "label": "%teamsfx.problemMatchers.teamsfxFrontendWatch%",
        "owner": "Teams Toolkit v2",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/tabs"
        ],
        "pattern": [
          {
            "regexp": "^.*?\\.js$",
            "file": 0
          },
          {
            "regexp": "^\\s*Line\\s+(\\d+):(\\d+):\\s+(.*)$",
            "line": 1,
            "column": 2,
            "message": 3
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": "Compiled|Failed"
        },
        "severity": "error"
      },
      {
        "name": "teamsfx-backend-watch",
        "label": "%teamsfx.problemMatchers.teamsfxbackendWatch%",
        "owner": "Teams Toolkit v2",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/api"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*(Job host stopped|signaling restart).*$",
          "endsPattern": "^.*(Worker process started and initialized|Host lock lease acquired by instance ID).*$"
        }
      },
      {
        "name": "teamsfx-auth-watch",
        "label": "%teamsfx.problemMatchers.teamsfxAuthWatch%",
        "owner": "Teams Toolkit v2",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": ".*"
        }
      },
      {
        "name": "teamsfx-ngrok-watch",
        "label": "%teamsfx.problemMatchers.teamsfxNgrokWatch%",
        "owner": "Teamsfx Toolkit V2",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "Session Status\\s*connecting",
          "endsPattern": ".*"
        }
      },
      {
        "name": "teamsfx-bot-watch",
        "label": "%teamsfx.problemMatchers.teamsfxBotWatch%",
        "owner": "Teamsfx Toolkit V2",
        "source": "teamsfx",
        "applyTo": "allDocuments",
        "fileLocation": [
          "relative",
          "${workspaceFolder}/bot"
        ],
        "pattern": [
          {
            "regexp": "^.*$",
            "file": 0,
            "location": 1,
            "message": 2
          }
        ],
        "background": {
          "activeOnStart": true,
          "beginsPattern": "[nodemon] starting",
          "endsPattern": "listening|[nodemon] app crashed"
        }
      }
    ],
    "configuration": [
      {
        "title": "Teams Toolkit",
        "properties": {
          "fx-extension.validateNode": {
            "type": "boolean",
            "description": "Validate the Node.js is installed before local debugging.",
            "default": true
          },
          "fx-extension.validateFuncCoreTools": {
            "type": "boolean",
            "description": "Validate the Azure Functions Core Tools is installed before local debugging.",
            "default": true
          },
          "fx-extension.validateDotnetSdk": {
            "type": "boolean",
            "description": "Validate the .NET SDK is installed before using it.",
            "default": true
          }
        }
      }
    ]
  },
  "scripts": {
    "lint:staged": "lint-staged",
    "vscode:prepublish": "rimraf out && npm run package",
    "copy-files": "copyfiles -u 1 src/**/*.html src/**/*.css src/**/*.ps1 src/**/*.sh out/src/",
    "compile": "tsc -p ./ && yarn copy-files",
    "build": "npm run compile",
    "watch": "webpack --watch --devtool nosources-source-map --info-verbosity verbose --config ./webpack.config.js",
    "package": "rimraf out && webpack --mode production --config ./webpack.config.js",
    "test-compile": "tsc -p ./",
    "test-watch": "tsc -watch -p ./",
    "pretest": "npm run lint && npm run check-format && npm run test-compile",
    "test": "node ./out/test/runTest.js",
    "check-format": "prettier --list-different --config .prettierrc.json --ignore-path .prettierignore \"src/**/*.ts\" \"test/**/*.ts\" \"*.{js,json}\"",
    "format": "prettier --write --config .prettierrc.json --ignore-path .prettierignore \"src/**/*.ts\" \"test/**/*.ts\" \"*.{js,json}\"",
    "lint:fix": "eslint --config .eslintrc.js package.json src test --ext .ts --fix --fix-type [problem,suggestion]",
    "lint": "eslint \"src/**/*.ts\" \"test/**/*.ts\"",
    "prepare": "npm run build"
  },
  "devDependencies": {
    "@shared/eslint-config": "^0.0.0",
    "@azure/arm-subscriptions": "^3.0.0",
    "@azure/eslint-plugin-azure-sdk": "^2.0.1",
    "@commitlint/cli": "^12.0.1",
    "@commitlint/config-conventional": "^12.0.1",
    "@fluentui/react": "^8.5.1",
    "@types/adm-zip": "^0.4.33",
    "@types/chai": "^4.2.14",
    "@types/chai-as-promised": "^7.1.3",
    "@types/chai-spies": "^1.0.3",
    "@types/express": "^4.17.11",
    "@types/fs-extra": "^9.0.5",
    "@types/glob": "^7.1.3",
    "@types/mocha": "^8.0.0",
    "@types/node": "^12.11.7",
    "@types/react": "^17.0.3",
    "@types/react-dom": "^17.0.2",
    "@types/react-router-dom": "^5.1.7",
    "@types/sinon": "^9.0.9",
    "@types/underscore": "^1.11.0",
    "@types/uuid": "^8.3.0",
    "@types/vscode": "^1.51.0",
    "@typescript-eslint/eslint-plugin": "^4.19.0",
    "@typescript-eslint/parser": "^4.19.0",
    "adm-zip": "^0.5.4",
    "chai": "^4.2.0",
    "chai-as-promised": "^7.1.1",
    "chai-spies": "^1.0.0",
    "copy-webpack-plugin": "^6.4.1",
    "copyfiles": "^2.4.1",
    "css-loader": "^5.1.3",
    "eslint": "^7.22.0",
    "fs-extra": "^9.0.1",
    "glob": "^7.1.6",
    "html-webpack-plugin": "^3.2.0",
    "husky": "^4.3.8",
    "lint-staged": "^10.5.4",
    "mocha": "^8.1.3",
    "mocha-junit-reporter": "^2.0.0",
    "mocha-multi-reporters": "^1.5.1",
    "mock-require": "^3.0.3",
    "ms-rest": "^2.5.4",
    "node-loader": "^2.0.0",
    "node-sass": "^5.0.0",
    "prettier": "^1.16.4",
    "react": "^17.0.2",
    "react-dom": "^17.0.2",
    "react-intl": "^5.13.5",
    "react-router-dom": "^5.2.0",
    "rimraf": "^3.0.2",
    "sass": "^1.32.8",
    "sass-loader": "^10.0.1",
    "sinon": "^9.2.2",
    "style-loader": "^2.0.0",
    "ts-loader": "^8.0.3",
    "ts-node": "^9.0.0",
    "typescript": "^4.2.4",
    "url-loader": "^4.1.1",
    "uuid": "^8.3.2",
    "webpack": "^4.44.1",
    "webpack-cli": "^3.3.12",
    "winston": "^3.3.3",
    "yarn": "^1.22.10"
  },
  "dependencies": {
    "@azure/identity": "^1.2.1",
    "@azure/ms-rest-nodeauth": "^3.0.7",
    "@azure/msal-node": "^1.0.0-beta.5",
    "async-mutex": "^0.3.1",
    "dotenv": "^8.2.0",
    "express": "^4.17.1",
    "fx-api": "^1.0.1",
    "fx-core": "^1.0.1",
    "jsonschema": "^1.4.0",
    "opn": "^6.0.0",
    "sudo-prompt": "^9.2.1",
    "underscore": "^1.12.1",
    "vscode-extension-telemetry": "^0.1.6",
    "vscode-test": "^1.5.2"
  },
  "lint-staged": {
    "**/*.ts": [
      "eslint"
    ]
  },
  "extensionDependencies": [
    "ms-vscode.azure-account"
  ],
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -e $HUSKY_GIT_PARAMS"
    }
  }
}
